(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory(require("@angular/core"), require("rest-core"), require("@angular/common/http"), require("rxjs/add/operator/filter"));
	else if(typeof define === 'function' && define.amd)
		define(["@angular/core", "rest-core", "@angular/common/http", "rxjs/add/operator/filter"], factory);
	else if(typeof exports === 'object')
		exports["rest-ngx"] = factory(require("@angular/core"), require("rest-core"), require("@angular/common/http"), require("rxjs/add/operator/filter"));
	else
		root["rest-ngx"] = factory(root["@angular/core"], root["rest-core"], root["@angular/common/http"], root["rxjs/add/operator/filter"]);
})(this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_6__) {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 4);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_0__;

/***/ }),
/* 1 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_1__;

/***/ }),
/* 2 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_2__;

/***/ }),
/* 3 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RestHandlerHttpClient; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_rest_core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_rest_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_rest_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__angular_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_common_http__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__angular_common_http___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__angular_common_http__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__RestHandlerAbstract__ = __webpack_require__(5);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_rxjs_add_operator_filter__ = __webpack_require__(6);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_rxjs_add_operator_filter___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_rxjs_add_operator_filter__);
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};





var RestHandlerHttpClient = /** @class */ (function (_super) {
    __extends(RestHandlerHttpClient, _super);
    function RestHandlerHttpClient(http) {
        var _this = _super.call(this) || this;
        _this.http = http;
        return _this;
    }
    RestHandlerHttpClient.prototype.request = function (request) {
        return this.http.request(request)
            .filter(function (resp) { return resp.type === __WEBPACK_IMPORTED_MODULE_2__angular_common_http__["HttpEventType"].Response; });
    };
    RestHandlerHttpClient.prototype.prepareRequest = function (req) {
        var method = 'GET';
        switch (req.method) {
            case __WEBPACK_IMPORTED_MODULE_0_rest_core__["RestRequestMethod"].Get:
                method = 'GET';
                break;
            case __WEBPACK_IMPORTED_MODULE_0_rest_core__["RestRequestMethod"].Post:
                method = 'POST';
                break;
            case __WEBPACK_IMPORTED_MODULE_0_rest_core__["RestRequestMethod"].Put:
                method = 'PUT';
                break;
            case __WEBPACK_IMPORTED_MODULE_0_rest_core__["RestRequestMethod"].Delete:
                method = 'DELETE';
                break;
            case __WEBPACK_IMPORTED_MODULE_0_rest_core__["RestRequestMethod"].Head:
                method = 'HEAD';
                break;
            case __WEBPACK_IMPORTED_MODULE_0_rest_core__["RestRequestMethod"].Options:
                method = 'OPTIONS';
                break;
            case __WEBPACK_IMPORTED_MODULE_0_rest_core__["RestRequestMethod"].Patch:
                method = 'PATCH';
        }
        var init = {
            withCredentials: req.withCredentials
        };
        switch (req.responseBodyType) {
            case __WEBPACK_IMPORTED_MODULE_0_rest_core__["RestResponseBodyType"].Json:
                init.responseType = 'json';
                break;
            case __WEBPACK_IMPORTED_MODULE_0_rest_core__["RestResponseBodyType"].ArrayBuffer:
                init.responseType = 'arraybuffer';
                break;
            case __WEBPACK_IMPORTED_MODULE_0_rest_core__["RestResponseBodyType"].Blob:
                init.responseType = 'blob';
                break;
            default:
                init.responseType = 'text';
        }
        if (req.headers) {
            init.headers = new __WEBPACK_IMPORTED_MODULE_2__angular_common_http__["HttpHeaders"](req.headers);
        }
        if (req.query) {
            init.params = new __WEBPACK_IMPORTED_MODULE_2__angular_common_http__["HttpParams"]();
            for (var key in req.query) {
                if (req.query.hasOwnProperty(key)) {
                    init.params = init.params.set(key, req.query[key]);
                }
            }
        }
        return new __WEBPACK_IMPORTED_MODULE_2__angular_common_http__["HttpRequest"](method, req.url, req.body, init);
    };
    RestHandlerHttpClient.prototype.handleResponse = function (req, response) {
        var headers = {};
        var keys = response.headers.keys();
        keys.forEach(function (key) {
            headers[key] = response.headers.getAll(key);
        });
        return {
            status: response.status,
            body: response.body,
            headers: headers
        };
    };
    RestHandlerHttpClient = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_1__angular_core__["Injectable"])(),
        __metadata("design:paramtypes", [__WEBPACK_IMPORTED_MODULE_2__angular_common_http__["HttpClient"]])
    ], RestHandlerHttpClient);
    return RestHandlerHttpClient;
}(__WEBPACK_IMPORTED_MODULE_3__RestHandlerAbstract__["a" /* RestHandlerAbstract */]));



/***/ }),
/* 4 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RestModule", function() { return RestModule; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__angular_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__angular_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_common_http__ = __webpack_require__(2);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_common_http___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__angular_common_http__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rest_core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_rest_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_rest_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__src_RestHandlerHttpClient__ = __webpack_require__(3);
/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, "RestHandlerHttpClient", function() { return __WEBPACK_IMPORTED_MODULE_3__src_RestHandlerHttpClient__["a"]; });
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};





var RestModule = /** @class */ (function () {
    function RestModule() {
    }
    RestModule_1 = RestModule;
    /**
     * For root
     * @param {IRestModuleConfig} config
     * @return {ModuleWithProviders}
     */
    RestModule.forRoot = function (config) {
        if (config === void 0) { config = {}; }
        return {
            ngModule: RestModule_1,
            providers: [
                config.handler || { provide: __WEBPACK_IMPORTED_MODULE_2_rest_core__["RestHandler"], useClass: __WEBPACK_IMPORTED_MODULE_3__src_RestHandlerHttpClient__["a" /* RestHandlerHttpClient */], deps: [__WEBPACK_IMPORTED_MODULE_1__angular_common_http__["HttpClient"]] }
            ]
        };
    };
    /**
     * For child
     * @param {IRestModuleConfig} config
     * @return {ModuleWithProviders}
     */
    RestModule.forChild = function (config) {
        if (config === void 0) { config = {}; }
        return {
            ngModule: RestModule_1,
            providers: [
                config.handler || { provide: __WEBPACK_IMPORTED_MODULE_2_rest_core__["RestHandler"], useClass: __WEBPACK_IMPORTED_MODULE_3__src_RestHandlerHttpClient__["a" /* RestHandlerHttpClient */], deps: [__WEBPACK_IMPORTED_MODULE_1__angular_common_http__["HttpClient"]] }
            ]
        };
    };
    RestModule = RestModule_1 = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_0__angular_core__["NgModule"])()
    ], RestModule);
    return RestModule;
    var RestModule_1;
}());



/***/ }),
/* 5 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return RestHandlerAbstract; });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_rest_core__ = __webpack_require__(1);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_rest_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_rest_core__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_core__ = __webpack_require__(0);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__angular_core___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__angular_core__);
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};


var RestHandlerAbstract = /** @class */ (function (_super) {
    __extends(RestHandlerAbstract, _super);
    function RestHandlerAbstract() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    RestHandlerAbstract.prototype.handle = function (req) {
        var _this = this;
        var request = this.prepareRequest(req);
        var resp = {
            promise: null
        };
        resp.promise = new Promise(function (resolve, reject) {
            var subscription = _this.request(request)
                .subscribe(function (resp) {
                subscription = null;
                resolve(_this.handleResponse(req, resp));
            }, function (err) {
                subscription = null;
                reject(_this.handleResponse(req, err));
            });
            resp.abort = function () {
                if (subscription) {
                    subscription.unsubscribe();
                    subscription = null;
                }
            };
        });
        return resp;
    };
    RestHandlerAbstract = __decorate([
        Object(__WEBPACK_IMPORTED_MODULE_1__angular_core__["Injectable"])()
    ], RestHandlerAbstract);
    return RestHandlerAbstract;
}(__WEBPACK_IMPORTED_MODULE_0_rest_core__["RestHandler"]));



/***/ }),
/* 6 */
/***/ (function(module, exports) {

module.exports = __WEBPACK_EXTERNAL_MODULE_6__;

/***/ })
/******/ ]);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCAxOTY2ZWMzZTg2Yzg1MDdjZmUyNSIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJAYW5ndWxhci9jb3JlXCIiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwicmVzdC1jb3JlXCIiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiQGFuZ3VsYXIvY29tbW9uL2h0dHBcIiIsIndlYnBhY2s6Ly8vLi9zcmMvUmVzdEhhbmRsZXJIdHRwQ2xpZW50LnRzIiwid2VicGFjazovLy8uL2luZGV4LnRzIiwid2VicGFjazovLy8uL3NyYy9SZXN0SGFuZGxlckFic3RyYWN0LnRzIiwid2VicGFjazovLy9leHRlcm5hbCBcInJ4anMvYWRkL29wZXJhdG9yL2ZpbHRlclwiIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxPO0FDVkE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQUs7QUFDTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG1DQUEyQiwwQkFBMEIsRUFBRTtBQUN2RCx5Q0FBaUMsZUFBZTtBQUNoRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw4REFBc0QsK0RBQStEOztBQUVySDtBQUNBOztBQUVBO0FBQ0E7Ozs7Ozs7QUM3REEsK0M7Ozs7OztBQ0FBLCtDOzs7Ozs7QUNBQSwrQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDQWlHO0FBQ3REO0FBQzBFO0FB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QyxDQUFDO1lBQ3hDLENBQUMsQ0FDRixDQUFDO1lBRUosSUFBSSxDQUFDLEtBQUssR0FBRztnQkFDWCxFQUFFLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO29CQUNqQixZQUFZLENBQUMsV0FBVyxFQUFFLENBQUM7b0JBQzNCLFlBQVksR0FBRyxJQUFJLENBQUM7Z0JBQ3RCLENBQUM7WUFDSCxDQUFDLENBQUM7UUFFSixDQUFDLENBQUMsQ0FBQztRQUVILE1BQU0sQ0FBQyxJQUFJLENBQUM7SUFFZCxDQUFDO0lBcENtQixtQkFBbUI7UUFEeEMsaUVBQVUsRUFBRTtPQUNTLG1CQUFtQixDQTRDeEM7SUFBRCwwQkFBQztDQUFBLENBNUNpRCxzREFBVyxHQTRDNUQ7QUE1Q3dDOzs7Ozs7O0FDTHpDLCtDIiwiZmlsZSI6InJlc3Qtbmd4LnVtZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZShcIkBhbmd1bGFyL2NvcmVcIiksIHJlcXVpcmUoXCJyZXN0LWNvcmVcIiksIHJlcXVpcmUoXCJAYW5ndWxhci9jb21tb24vaHR0cFwiKSwgcmVxdWlyZShcInJ4anMvYWRkL29wZXJhdG9yL2ZpbHRlclwiKSk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXCJAYW5ndWxhci9jb3JlXCIsIFwicmVzdC1jb3JlXCIsIFwiQGFuZ3VsYXIvY29tbW9uL2h0dHBcIiwgXCJyeGpzL2FkZC9vcGVyYXRvci9maWx0ZXJcIl0sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wicmVzdC1uZ3hcIl0gPSBmYWN0b3J5KHJlcXVpcmUoXCJAYW5ndWxhci9jb3JlXCIpLCByZXF1aXJlKFwicmVzdC1jb3JlXCIpLCByZXF1aXJlKFwiQGFuZ3VsYXIvY29tbW9uL2h0dHBcIiksIHJlcXVpcmUoXCJyeGpzL2FkZC9vcGVyYXRvci9maWx0ZXJcIikpO1xuXHRlbHNlXG5cdFx0cm9vdFtcInJlc3Qtbmd4XCJdID0gZmFjdG9yeShyb290W1wiQGFuZ3VsYXIvY29yZVwiXSwgcm9vdFtcInJlc3QtY29yZVwiXSwgcm9vdFtcIkBhbmd1bGFyL2NvbW1vbi9odHRwXCJdLCByb290W1wicnhqcy9hZGQvb3BlcmF0b3IvZmlsdGVyXCJdKTtcbn0pKHRoaXMsIGZ1bmN0aW9uKF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMF9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzFfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8yX18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfNl9fKSB7XG5yZXR1cm4gXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9cIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA0KTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCAxOTY2ZWMzZTg2Yzg1MDdjZmUyNSIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8wX187XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJAYW5ndWxhci9jb3JlXCJcbi8vIG1vZHVsZSBpZCA9IDBcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzFfXztcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInJlc3QtY29yZVwiXG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8yX187XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJAYW5ndWxhci9jb21tb24vaHR0cFwiXG4vLyBtb2R1bGUgaWQgPSAyXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsImltcG9ydCB7IElSZXN0UmVxdWVzdCwgSVJlc3RSZXNwb25zZSwgUmVzdFJlcXVlc3RNZXRob2QsIFJlc3RSZXNwb25zZUJvZHlUeXBlIH0gZnJvbSAncmVzdC1jb3JlJztcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEh0dHBDbGllbnQsIEh0dHBFdmVudFR5cGUsIEh0dHBIZWFkZXJzLCBIdHRwUGFyYW1zLCBIdHRwUmVxdWVzdCwgSHR0cFJlc3BvbnNlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgUmVzdEhhbmRsZXJBYnN0cmFjdCB9IGZyb20gJy4vUmVzdEhhbmRsZXJBYnN0cmFjdCc7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcy9PYnNlcnZhYmxlJztcblxuaW1wb3J0ICdyeGpzL2FkZC9vcGVyYXRvci9maWx0ZXInO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgUmVzdEhhbmRsZXJIdHRwQ2xpZW50IGV4dGVuZHMgUmVzdEhhbmRsZXJBYnN0cmFjdCB7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50KSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIHByb3RlY3RlZCByZXF1ZXN0KHJlcXVlc3Q6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5yZXF1ZXN0KHJlcXVlc3QpXG4gICAgICAuZmlsdGVyKChyZXNwOiBIdHRwUmVzcG9uc2U8b2JqZWN0PikgPT4gcmVzcC50eXBlID09PSBIdHRwRXZlbnRUeXBlLlJlc3BvbnNlKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBwcmVwYXJlUmVxdWVzdChyZXE6IElSZXN0UmVxdWVzdCk6IEh0dHBSZXF1ZXN0PGFueT4ge1xuXG4gICAgbGV0IG1ldGhvZDogc3RyaW5nID0gJ0dFVCc7XG5cbiAgICBzd2l0Y2ggKHJlcS5tZXRob2QpIHtcblxuICAgICAgY2FzZSBSZXN0UmVxdWVzdE1ldGhvZC5HZXQ6XG4gICAgICAgIG1ldGhvZCA9ICdHRVQnO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBSZXN0UmVxdWVzdE1ldGhvZC5Qb3N0OlxuICAgICAgICBtZXRob2QgPSAnUE9TVCc7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFJlc3RSZXF1ZXN0TWV0aG9kLlB1dDpcbiAgICAgICAgbWV0aG9kID0gJ1BVVCc7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFJlc3RSZXF1ZXN0TWV0aG9kLkRlbGV0ZTpcbiAgICAgICAgbWV0aG9kID0gJ0RFTEVURSc7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFJlc3RSZXF1ZXN0TWV0aG9kLkhlYWQ6XG4gICAgICAgIG1ldGhvZCA9ICdIRUFEJztcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgUmVzdFJlcXVlc3RNZXRob2QuT3B0aW9uczpcbiAgICAgICAgbWV0aG9kID0gJ09QVElPTlMnO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBSZXN0UmVxdWVzdE1ldGhvZC5QYXRjaDpcbiAgICAgICAgbWV0aG9kID0gJ1BBVENIJztcblxuICAgIH1cblxuICAgIGNvbnN0IGluaXQ6IElIdHRwUmVxdWVzdEluaXQgPSB7XG4gICAgICB3aXRoQ3JlZGVudGlhbHM6IHJlcS53aXRoQ3JlZGVudGlhbHNcbiAgICB9O1xuXG4gICAgc3dpdGNoIChyZXEucmVzcG9uc2VCb2R5VHlwZSkge1xuXG4gICAgICBjYXNlIFJlc3RSZXNwb25zZUJvZHlUeXBlLkpzb246XG4gICAgICAgIGluaXQucmVzcG9uc2VUeXBlID0gJ2pzb24nO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBSZXN0UmVzcG9uc2VCb2R5VHlwZS5BcnJheUJ1ZmZlcjpcbiAgICAgICAgaW5pdC5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBSZXN0UmVzcG9uc2VCb2R5VHlwZS5CbG9iOlxuICAgICAgICBpbml0LnJlc3BvbnNlVHlwZSA9ICdibG9iJztcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGluaXQucmVzcG9uc2VUeXBlID0gJ3RleHQnO1xuXG4gICAgfVxuXG4gICAgaWYgKHJlcS5oZWFkZXJzKSB7XG4gICAgICBpbml0LmhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMocmVxLmhlYWRlcnMpO1xuICAgIH1cblxuICAgIGlmIChyZXEucXVlcnkpIHtcbiAgICAgIGluaXQucGFyYW1zID0gbmV3IEh0dHBQYXJhbXMoKTtcbiAgICAgIGZvciAoY29uc3Qga2V5IGluIHJlcS5xdWVyeSkge1xuICAgICAgICBpZiAocmVxLnF1ZXJ5Lmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICBpbml0LnBhcmFtcyA9IGluaXQucGFyYW1zLnNldChrZXksIHJlcS5xdWVyeVtrZXldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBuZXcgSHR0cFJlcXVlc3QobWV0aG9kLCByZXEudXJsLCByZXEuYm9keSwgaW5pdCk7XG5cbiAgfVxuXG4gIHByb3RlY3RlZCBoYW5kbGVSZXNwb25zZShyZXE6IElSZXN0UmVxdWVzdCwgcmVzcG9uc2U6IEh0dHBSZXNwb25zZTxhbnk+KTogSVJlc3RSZXNwb25zZSB7XG5cbiAgICBjb25zdCBoZWFkZXJzOiBhbnkgPSB7fTtcbiAgICBjb25zdCBrZXlzID0gcmVzcG9uc2UuaGVhZGVycy5rZXlzKCk7XG4gICAga2V5cy5mb3JFYWNoKChrZXk6IHN0cmluZykgPT4ge1xuICAgICAgaGVhZGVyc1trZXldID0gcmVzcG9uc2UuaGVhZGVycy5nZXRBbGwoa2V5KTtcbiAgICB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgIGJvZHk6IHJlc3BvbnNlLmJvZHksXG4gICAgICBoZWFkZXJzOiBoZWFkZXJzXG4gICAgfTtcbiAgfVxuXG59XG5cblxuZXhwb3J0IGludGVyZmFjZSBJSHR0cFJlcXVlc3RJbml0IHtcbiAgaGVhZGVycz86IEh0dHBIZWFkZXJzO1xuICBwYXJhbXM/OiBIdHRwUGFyYW1zO1xuICByZXNwb25zZVR5cGU/OiAnYXJyYXlidWZmZXInIHwgJ2Jsb2InIHwgJ2pzb24nIHwgJ3RleHQnO1xuICB3aXRoQ3JlZGVudGlhbHM/OiBib29sZWFuO1xufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL1Jlc3RIYW5kbGVySHR0cENsaWVudC50cyIsImltcG9ydCB7IE1vZHVsZVdpdGhQcm92aWRlcnMsIE5nTW9kdWxlLCBQcm92aWRlciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7IFJlc3RIYW5kbGVyIH0gZnJvbSAncmVzdC1jb3JlJztcbmltcG9ydCB7IFJlc3RIYW5kbGVySHR0cENsaWVudCB9IGZyb20gJy4vc3JjL1Jlc3RIYW5kbGVySHR0cENsaWVudCc7XG5cbmV4cG9ydCAqIGZyb20gJy4vc3JjL1Jlc3RIYW5kbGVySHR0cENsaWVudCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVJlc3RNb2R1bGVDb25maWcge1xuICBoYW5kbGVyPzogUHJvdmlkZXI7XG59XG5cbkBOZ01vZHVsZSgpXG5leHBvcnQgY2xhc3MgUmVzdE1vZHVsZSB7XG5cbiAgLyoqXG4gICAqIEZvciByb290XG4gICAqIEBwYXJhbSB7SVJlc3RNb2R1bGVDb25maWd9IGNvbmZpZ1xuICAgKiBAcmV0dXJuIHtNb2R1bGVXaXRoUHJvdmlkZXJzfVxuICAgKi9cbiAgc3RhdGljIGZvclJvb3QoY29uZmlnOiBJUmVzdE1vZHVsZUNvbmZpZyA9IHt9KTogTW9kdWxlV2l0aFByb3ZpZGVycyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5nTW9kdWxlOiBSZXN0TW9kdWxlLFxuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIGNvbmZpZy5oYW5kbGVyIHx8IHtwcm92aWRlOiBSZXN0SGFuZGxlciwgdXNlQ2xhc3M6IFJlc3RIYW5kbGVySHR0cENsaWVudCwgZGVwczogW0h0dHBDbGllbnRdfVxuICAgICAgXVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogRm9yIGNoaWxkXG4gICAqIEBwYXJhbSB7SVJlc3RNb2R1bGVDb25maWd9IGNvbmZpZ1xuICAgKiBAcmV0dXJuIHtNb2R1bGVXaXRoUHJvdmlkZXJzfVxuICAgKi9cbiAgc3RhdGljIGZvckNoaWxkKGNvbmZpZzogSVJlc3RNb2R1bGVDb25maWcgPSB7fSk6IE1vZHVsZVdpdGhQcm92aWRlcnMge1xuICAgIHJldHVybiB7XG4gICAgICBuZ01vZHVsZTogUmVzdE1vZHVsZSxcbiAgICAgIHByb3ZpZGVyczogW1xuICAgICAgICBjb25maWcuaGFuZGxlciB8fCB7cHJvdmlkZTogUmVzdEhhbmRsZXIsIHVzZUNsYXNzOiBSZXN0SGFuZGxlckh0dHBDbGllbnQsIGRlcHM6IFtIdHRwQ2xpZW50XX1cbiAgICAgIF1cbiAgICB9O1xuICB9XG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9pbmRleC50cyIsImltcG9ydCB7IElSZXN0SGFuZGxlclJlc3BvbnNlLCBJUmVzdFJlcXVlc3QsIElSZXN0UmVzcG9uc2UsIFJlc3RIYW5kbGVyIH0gZnJvbSAncmVzdC1jb3JlJztcbmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzL09ic2VydmFibGUnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgUmVzdEhhbmRsZXJBYnN0cmFjdCBleHRlbmRzIFJlc3RIYW5kbGVyIHtcblxuXG4gIGhhbmRsZShyZXE6IElSZXN0UmVxdWVzdCk6IElSZXN0SGFuZGxlclJlc3BvbnNlIHtcblxuICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLnByZXBhcmVSZXF1ZXN0KHJlcSk7XG5cbiAgICBjb25zdCByZXNwOiBJUmVzdEhhbmRsZXJSZXNwb25zZSA9IHtcbiAgICAgIHByb21pc2U6IG51bGxcbiAgICB9O1xuXG4gICAgcmVzcC5wcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXG4gICAgICBsZXQgc3Vic2NyaXB0aW9uID0gdGhpcy5yZXF1ZXN0KHJlcXVlc3QpXG4gICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgKHJlc3A6IGFueSkgPT4ge1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIHJlc29sdmUodGhpcy5oYW5kbGVSZXNwb25zZShyZXEsIHJlc3ApKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIChlcnI6IGFueSkgPT4ge1xuICAgICAgICAgICAgc3Vic2NyaXB0aW9uID0gbnVsbDtcbiAgICAgICAgICAgIHJlamVjdCh0aGlzLmhhbmRsZVJlc3BvbnNlKHJlcSwgZXJyKSk7XG4gICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICByZXNwLmFib3J0ID0gKCkgPT4ge1xuICAgICAgICBpZiAoc3Vic2NyaXB0aW9uKSB7XG4gICAgICAgICAgc3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgc3Vic2NyaXB0aW9uID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJlc3A7XG5cbiAgfVxuXG4gIHByb3RlY3RlZCBhYnN0cmFjdCByZXF1ZXN0KHJlcXVlc3Q6IGFueSk6IE9ic2VydmFibGU8YW55PjtcblxuICBwcm90ZWN0ZWQgYWJzdHJhY3QgcHJlcGFyZVJlcXVlc3QocmVxOiBJUmVzdFJlcXVlc3QpOiBhbnk7XG5cbiAgcHJvdGVjdGVkIGFic3RyYWN0IGhhbmRsZVJlc3BvbnNlKHJlcTogSVJlc3RSZXF1ZXN0LCByZXNwb25zZTogYW55KTogSVJlc3RSZXNwb25zZTtcblxufVxuXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvUmVzdEhhbmRsZXJBYnN0cmFjdC50cyIsIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV82X187XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gZXh0ZXJuYWwgXCJyeGpzL2FkZC9vcGVyYXRvci9maWx0ZXJcIlxuLy8gbW9kdWxlIGlkID0gNlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9